<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css" media="screen">.code {white-space: pre-wrap;  font-family: monospace;}
.hot {background-color:#FF0000;}
.pad {background-color:#CCCCCC;}
.lineno {background-color:#CCCCCC;}
</style>
</head>
<body>
<h3>Edit distance is 27</h3>
<table width="80%" rules="rows">
<tr>
<th>LineNo</th><th>C:\Users\rav\Documents\JAVA\plsqldiff\example\csv1.pck</th><th>LineNo</th><th>C:\Users\rav\Documents\JAVA\plsqldiff\example\csv2.pck</th>
</tr>
<tr>
<td class="lineno">1</td><td class="code">create or replace package body csv is&#13;</td><td class="lineno">1</td><td class="code">CREATE OR REPLACE PACKAGE BODY csv IS&#13;</td>
</tr>
<tr>
<td class="lineno">2</td><td class="code">&#13;</td><td class="lineno">2</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">3</td><td class="code">  g_p integer;&#13;</td><td class="lineno">3</td><td class="code">  g_p INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">4</td><td class="code">&#13;</td><td class="lineno">4</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">5</td><td class="code">  --  k_past_end    integer :=4;&#13;</td><td class="lineno">5</td><td class="code">  --  k_past_end    integer :=4;&#13;</td>
</tr>
<tr>
<td class="lineno">6</td><td class="code">&#13;</td><td class="lineno">6</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">7</td><td class="code">  k_clob    integer := 1;&#13;</td><td class="lineno">7</td><td class="code">  k_clob    INTEGER := 1;&#13;</td>
</tr>
<tr>
<td class="lineno">8</td><td class="code">  k_varchar integer := 2;&#13;</td><td class="lineno">8</td><td class="code">  k_varchar INTEGER := 2;&#13;</td>
</tr>
<tr>
<td class="lineno">9</td><td class="code">&#13;</td><td class="lineno">9</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">10</td><td class="code">  g_what integer;&#13;</td><td class="lineno">10</td><td class="code">  g_what INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">11</td><td class="code">&#13;</td><td class="lineno">11</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">12</td><td class="code">  g_clob clob;&#13;</td><td class="lineno">12</td><td class="code">  g_clob CLOB;&#13;</td>
</tr>
<tr>
<td class="lineno">13</td><td class="code">&#13;</td><td class="lineno">13</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">14</td><td class="code">  g_quote_char varchar2(1);&#13;</td><td class="lineno">14</td><td class="code">  g_quote_char VARCHAR2(1);&#13;</td>
</tr>
<tr>
<td class="lineno">15</td><td class="code">  g_delim_char varchar2(1);&#13;</td><td class="lineno">15</td><td class="code">  g_delim_char VARCHAR2(1);&#13;</td>
</tr>
<tr>
<td class="lineno">16</td><td class="code">  &#13;</td><td class="lineno">16</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">17</td><td class="code">  g_varchar2 varchar2(32000);&#13;</td><td class="lineno">17</td><td class="code">  g_varchar2 VARCHAR2(32000);&#13;</td>
</tr>
<tr>
<td class="lineno">18</td><td class="code">&#13;</td><td class="lineno">18</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">19</td><td class="code">  procedure p(x varchar2) is&#13;</td><td class="lineno">19</td><td class="code">  PROCEDURE p(x VARCHAR2) IS&#13;</td>
</tr>
<tr>
<td class="lineno">20</td><td class="code">  begin&#13;</td><td class="lineno">20</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">21</td><td class="code">    null;&#13;</td><td class="lineno">21</td><td class="code">    NULL;&#13;</td>
</tr>
<tr>
<td class="lineno">22</td><td class="code">    dbms_output.put_line(x);&#13;</td><td class="lineno">22</td><td class="code">    dbms_output.put_line(x);&#13;</td>
</tr>
<tr>
<td class="lineno">23</td><td class="code">  end;&#13;</td><td class="lineno">23</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">24</td><td class="code">&#13;</td><td class="lineno">24</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">25</td><td class="code">  function instr2(y varchar2</td><td class="lineno">25</td><td class="code">  FUNCTION instr2(y VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">25</td><td class="code"><span class="pad">                            </span>, p integer) return integer is&#13;</td><td class="lineno">26</td><td class="code">                 ,p INTEGER) RETURN INTEGER IS&#13;</td>
</tr>
<tr>
<td class="lineno">26</td><td class="code">  begin&#13;</td><td class="lineno">27</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">27</td><td class="code">    if g_what = k_clob</td><td class="lineno">28</td><td class="code">    IF g_what = k_clob&#13;</td>
</tr>
<tr>
<td class="lineno">27</td><td class="code"><span class="pad">                      </span> then&#13;</td><td class="lineno">29</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">28</td><td class="code">      return dbms_lob.instr(lob_loc =&gt; g_clob</td><td class="lineno">30</td><td class="code">      RETURN dbms_lob.instr(lob_loc =&gt; g_clob&#13;</td>
</tr>
<tr>
<td class="lineno">28</td><td class="code"><span class="pad">                                             </span>, pattern =&gt; y</td><td class="lineno">31</td><td class="code">                           ,pattern =&gt; y&#13;</td>
</tr>
<tr>
<td class="lineno">28</td><td class="code"><span class="pad">                                                           </span>, offset =&gt; p);&#13;</td><td class="lineno">32</td><td class="code">                           ,offset  =&gt; p);&#13;</td>
</tr>
<tr>
<td class="lineno">29</td><td class="code">    elsif g_what = k_varchar</td><td class="lineno">33</td><td class="code">    ELSIF g_what = k_varchar&#13;</td>
</tr>
<tr>
<td class="lineno">29</td><td class="code"><span class="pad">                            </span> then&#13;</td><td class="lineno">34</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">30</td><td class="code">      return instr(g_varchar2</td><td class="lineno">35</td><td class="code">      RETURN instr(g_varchar2&#13;</td>
</tr>
<tr>
<td class="lineno">30</td><td class="code"><span class="pad">                             </span>, y</td><td class="lineno">36</td><td class="code">                  ,y&#13;</td>
</tr>
<tr>
<td class="lineno">30</td><td class="code"><span class="pad">                                </span>, p);&#13;</td><td class="lineno">37</td><td class="code">                  ,p);&#13;</td>
</tr>
<tr>
<td class="lineno">31</td><td class="code">    end if;&#13;</td><td class="lineno">38</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">32</td><td class="code">  end;&#13;</td><td class="lineno">39</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">33</td><td class="code">&#13;</td><td class="lineno">40</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">34</td><td class="code"> function substrclob(i_from integer</td><td class="lineno">41</td><td class="code">  FUNCTION substrclob(i_from INTEGER&#13;</td>
</tr>
<tr>
<td class="lineno">34</td><td class="code"><span class="pad">                                   </span>, i_to1 integer) return varchar2 is&#13;</td><td class="lineno">42</td><td class="code">                     ,i_to1  INTEGER) RETURN VARCHAR2 IS&#13;</td>
</tr>
<tr>
<td class="lineno">35</td><td class="code">    begin&#13;</td><td class="lineno">43</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">36</td><td class="code">      if i_from+4000&gt;=i_to1</td><td class="lineno">44</td><td class="code">    IF i_from + 4000 &gt;= i_to1&#13;</td>
</tr>
<tr>
<td class="lineno">36</td><td class="code"><span class="pad">                           </span> then&#13;</td><td class="lineno">45</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">37</td><td class="code">       return dbms_lob.substr(lob_loc =&gt; g_clob</td><td class="lineno">46</td><td class="code">      RETURN dbms_lob.substr(lob_loc =&gt; g_clob&#13;</td>
</tr>
<tr>
<td class="lineno">37</td><td class="code"><span class="pad">                                               </span>,&#13;</td><td class="lineno">47</td><td class="code">                            ,</td>
</tr>
<tr>
<td class="lineno">38</td><td class="code">                             amount  =&gt; i_to1 - i_from</td><td class="lineno">47</td><td class="code"><span class="pad">                             </span>amount  =&gt; i_to1 - i_from&#13;</td>
</tr>
<tr>
<td class="lineno">38</td><td class="code"><span class="pad">                                                      </span>,&#13;</td><td class="lineno">48</td><td class="code">                            ,</td>
</tr>
<tr>
<td class="lineno">39</td><td class="code">                             offset  =&gt; i_from);&#13;</td><td class="lineno">48</td><td class="code"><span class="pad">                             </span>offset  =&gt; i_from);&#13;</td>
</tr>
<tr>
<td class="lineno">40</td><td class="code">      else&#13;</td><td class="lineno">49</td><td class="code">    ELSE&#13;</td>
</tr>
<tr>
<td class="lineno">41</td><td class="code">        declare</td><td class="lineno">50</td><td class="code">      DECLARE&#13;</td>
</tr>
<tr>
<td class="lineno">41</td><td class="code"><span class="pad">               </span> a integer:= trunc((i_to1 +i_from)/2);&#13;</td><td class="lineno">51</td><td class="code">        a INTEGER := trunc((i_to1 + i_from) / 2);&#13;</td>
</tr>
<tr>
<td class="lineno">42</td><td class="code">        begin&#13;</td><td class="lineno">52</td><td class="code">      BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">43</td><td class="code">         return substrclob(i_from</td><td class="lineno">53</td><td class="code">        RETURN substrclob(i_from&#13;</td>
</tr>
<tr>
<td class="lineno">43</td><td class="code"><span class="pad">                                 </span>,a)||substrclob(a</td><td class="lineno">54</td><td class="code">                         ,a) || substrclob(a&#13;</td>
</tr>
<tr>
<td class="lineno">43</td><td class="code"><span class="pad">                                                  </span>,i_to1);&#13;</td><td class="lineno">55</td><td class="code">                                          ,i_to1);&#13;</td>
</tr>
<tr>
<td class="lineno">44</td><td class="code">         end;&#13;</td><td class="lineno">56</td><td class="code">      END;&#13;</td>
</tr>
<tr>
<td class="lineno">45</td><td class="code">       end if;&#13;</td><td class="lineno">57</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">46</td><td class="code">      end;&#13;</td><td class="lineno">58</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">47</td><td class="code">&#13;</td><td class="lineno">59</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">48</td><td class="code">&#13;</td><td class="lineno"></td><td class="code"></td>
</tr>
<tr>
<td class="lineno">49</td><td class="code">  function substr2(i_from integer</td><td class="lineno">60</td><td class="code">  FUNCTION substr2(i_from INTEGER&#13;</td>
</tr>
<tr>
<td class="lineno">49</td><td class="code"><span class="pad">                                 </span>, i_to1 integer) return <span class="hot">varchar2</span> is&#13;</td><td class="lineno">61</td><td class="code">                  ,i_to1  INTEGER) RETURN <span class="hot">varchar2x</span> IS&#13;</td>
</tr>
<tr>
<td class="lineno">50</td><td class="code">  begin&#13;</td><td class="lineno">62</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">51</td><td class="code">    if g_what = k_clob</td><td class="lineno">63</td><td class="code">    IF g_what = k_clob&#13;</td>
</tr>
<tr>
<td class="lineno">51</td><td class="code"><span class="pad">                      </span> then&#13;</td><td class="lineno">64</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">52</td><td class="code">      return substrclob(i_from</td><td class="lineno">65</td><td class="code">      RETURN substrclob(i_from&#13;</td>
</tr>
<tr>
<td class="lineno">52</td><td class="code"><span class="pad">                              </span>,i_to1);&#13;</td><td class="lineno">66</td><td class="code">                       ,i_to1);&#13;</td>
</tr>
<tr>
<td class="lineno">53</td><td class="code">    elsif g_what = k_varchar</td><td class="lineno">67</td><td class="code">    ELSIF g_what = k_varchar&#13;</td>
</tr>
<tr>
<td class="lineno">53</td><td class="code"><span class="pad">                            </span> then&#13;</td><td class="lineno">68</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">54</td><td class="code">      return substr(g_varchar2</td><td class="lineno">69</td><td class="code">      RETURN substr(g_varchar2&#13;</td>
</tr>
<tr>
<td class="lineno">54</td><td class="code"><span class="pad">                              </span>, i_from</td><td class="lineno">70</td><td class="code">                   ,i_from&#13;</td>
</tr>
<tr>
<td class="lineno">54</td><td class="code"><span class="pad">                                      </span>, i_to1 - i_from);&#13;</td><td class="lineno">71</td><td class="code">                   ,i_to1 - i_from);&#13;</td>
</tr>
<tr>
<td class="lineno">55</td><td class="code">    end if;&#13;</td><td class="lineno">72</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">56</td><td class="code">  end;&#13;</td><td class="lineno">73</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">57</td><td class="code">  &#13;</td><td class="lineno">74</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">58</td><td class="code"> &#13;</td><td class="lineno"></td><td class="code"></td>
</tr>
<tr>
<td class="lineno">59</td><td class="code">  function len2 return integer is&#13;</td><td class="lineno">75</td><td class="code">  FUNCTION len2 RETURN INTEGER IS&#13;</td>
</tr>
<tr>
<td class="lineno">60</td><td class="code">  begin&#13;</td><td class="lineno">76</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">61</td><td class="code">    if g_what = k_clob</td><td class="lineno">77</td><td class="code">    IF g_what = k_clob&#13;</td>
</tr>
<tr>
<td class="lineno">61</td><td class="code"><span class="pad">                      </span> then&#13;</td><td class="lineno">78</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">62</td><td class="code">      return nvl(dbms_lob.getlength(g_clob)</td><td class="lineno">79</td><td class="code">      RETURN nvl(dbms_lob.getlength(g_clob)&#13;</td>
</tr>
<tr>
<td class="lineno">62</td><td class="code"><span class="pad">                                           </span>, 0);&#13;</td><td class="lineno">80</td><td class="code">                ,0);&#13;</td>
</tr>
<tr>
<td class="lineno">63</td><td class="code">    elsif g_what = k_varchar</td><td class="lineno">81</td><td class="code">    ELSIF g_what = k_varchar&#13;</td>
</tr>
<tr>
<td class="lineno">63</td><td class="code"><span class="pad">                            </span> then&#13;</td><td class="lineno">82</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">64</td><td class="code">      return nvl(length(g_varchar2)</td><td class="lineno">83</td><td class="code">      RETURN nvl(length(g_varchar2)&#13;</td>
</tr>
<tr>
<td class="lineno">64</td><td class="code"><span class="pad">                                   </span>, 0);&#13;</td><td class="lineno">84</td><td class="code">                ,0);&#13;</td>
</tr>
<tr>
<td class="lineno">65</td><td class="code">    end if;&#13;</td><td class="lineno">85</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">66</td><td class="code">  end;&#13;</td><td class="lineno">86</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">67</td><td class="code">&#13;</td><td class="lineno">87</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">68</td><td class="code">  procedure clob_init(i_clob in clob</td><td class="lineno">88</td><td class="code">  PROCEDURE clob_init(i_clob  IN CLOB&#13;</td>
</tr>
<tr>
<td class="lineno">68</td><td class="code"><span class="pad">                                    </span>, i_delim varchar2</td><td class="lineno">89</td><td class="code">                     ,i_delim VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">68</td><td class="code"><span class="pad">                                                      </span>, i_quote varchar2) is&#13;</td><td class="lineno">90</td><td class="code">                     ,i_quote VARCHAR2) IS&#13;</td>
</tr>
<tr>
<td class="lineno">69</td><td class="code">  begin&#13;</td><td class="lineno">91</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">70</td><td class="code">    g_what := k_clob;&#13;</td><td class="lineno">92</td><td class="code">    g_what := k_clob;&#13;</td>
</tr>
<tr>
<td class="lineno">71</td><td class="code">    g_clob := i_clob;&#13;</td><td class="lineno">93</td><td class="code">    g_clob := i_clob;&#13;</td>
</tr>
<tr>
<td class="lineno">72</td><td class="code">    g_p    := 1;&#13;</td><td class="lineno">94</td><td class="code">    g_p    := 1;&#13;</td>
</tr>
<tr>
<td class="lineno">73</td><td class="code">    set_chars(i_delim</td><td class="lineno">95</td><td class="code">    set_chars(i_delim&#13;</td>
</tr>
<tr>
<td class="lineno">73</td><td class="code"><span class="pad">                     </span>, i_quote);&#13;</td><td class="lineno">96</td><td class="code">             ,i_quote);&#13;</td>
</tr>
<tr>
<td class="lineno">74</td><td class="code">  end;&#13;</td><td class="lineno">97</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">75</td><td class="code">&#13;</td><td class="lineno">98</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">76</td><td class="code">  procedure varchar_init(i_varchar2 in varchar2</td><td class="lineno">99</td><td class="code">  PROCEDURE varchar_init(i_varchar2 IN VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">76</td><td class="code"><span class="pad">                                               </span>,&#13;</td><td class="lineno">100</td><td class="code">                        ,</td>
</tr>
<tr>
<td class="lineno">77</td><td class="code">                         i_delim    varchar2</td><td class="lineno">100</td><td class="code"><span class="pad">                         </span>i_delim    VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">77</td><td class="code"><span class="pad">                                            </span>,&#13;</td><td class="lineno">101</td><td class="code">                        ,</td>
</tr>
<tr>
<td class="lineno">78</td><td class="code">                         i_quote    varchar2) is&#13;</td><td class="lineno">101</td><td class="code"><span class="pad">                         </span>i_quote    VARCHAR2) IS&#13;</td>
</tr>
<tr>
<td class="lineno">79</td><td class="code">  begin&#13;</td><td class="lineno">102</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">80</td><td class="code">    g_what := k_varchar;&#13;</td><td class="lineno">103</td><td class="code">    g_what     := k_varchar;&#13;</td>
</tr>
<tr>
<td class="lineno">81</td><td class="code">    g_p    := 1;&#13;</td><td class="lineno">104</td><td class="code">    g_p        := 1;&#13;</td>
</tr>
<tr>
<td class="lineno">82</td><td class="code">    g_varchar2 := i_varchar2;&#13;</td><td class="lineno">105</td><td class="code">    g_varchar2 := i_varchar2;&#13;</td>
</tr>
<tr>
<td class="lineno">83</td><td class="code">    set_chars(i_delim</td><td class="lineno">106</td><td class="code">    set_chars(i_delim&#13;</td>
</tr>
<tr>
<td class="lineno">83</td><td class="code"><span class="pad">                     </span>, i_quote);&#13;</td><td class="lineno">107</td><td class="code">             ,i_quote);&#13;</td>
</tr>
<tr>
<td class="lineno">84</td><td class="code">  end;&#13;</td><td class="lineno">108</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">85</td><td class="code">&#13;</td><td class="lineno">109</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">86</td><td class="code">  procedure set_chars(i_delim varchar2</td><td class="lineno">110</td><td class="code">  PROCEDURE set_chars(i_delim VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">86</td><td class="code"><span class="pad">                                      </span>, i_quote varchar2) is&#13;</td><td class="lineno">111</td><td class="code">                     ,i_quote VARCHAR2) IS&#13;</td>
</tr>
<tr>
<td class="lineno">87</td><td class="code">  begin&#13;</td><td class="lineno">112</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">88</td><td class="code">    g_delim_char := i_delim;&#13;</td><td class="lineno">113</td><td class="code">    g_delim_char := i_delim;&#13;</td>
</tr>
<tr>
<td class="lineno">89</td><td class="code">    g_quote_char := i_quote;&#13;</td><td class="lineno">114</td><td class="code">    g_quote_char := i_quote;&#13;</td>
</tr>
<tr>
<td class="lineno">90</td><td class="code">  end;&#13;</td><td class="lineno">115</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">91</td><td class="code">&#13;</td><td class="lineno">116</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">92</td><td class="code">  procedure reset(p integer) is&#13;</td><td class="lineno">117</td><td class="code">  PROCEDURE reset(p INTEGER) IS&#13;</td>
</tr>
<tr>
<td class="lineno">93</td><td class="code">  begin&#13;</td><td class="lineno">118</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">94</td><td class="code">    g_p := p;&#13;</td><td class="lineno">119</td><td class="code">    g_p := p;&#13;</td>
</tr>
<tr>
<td class="lineno">95</td><td class="code">    --   if p + g_p - 1 &gt; nvl(length(g_buff), 0) + 1 then&#13;</td><td class="lineno">120</td><td class="code">    --   if p + g_p - 1 &gt; nvl(length(g_buff), 0) + 1 then&#13;</td>
</tr>
<tr>
<td class="lineno">96</td><td class="code">    --     raise_application_error(-20001, 'bug');&#13;</td><td class="lineno">121</td><td class="code">    --     raise_application_error(-20001, 'bug');&#13;</td>
</tr>
<tr>
<td class="lineno">97</td><td class="code">    --    end if;&#13;</td><td class="lineno">122</td><td class="code">    --    end if;&#13;</td>
</tr>
<tr>
<td class="lineno">98</td><td class="code">    --   g_buff := substr(g_buff, p + g_p - 1); --, nvl(length(g_buff), 0) - p + 1);&#13;</td><td class="lineno">123</td><td class="code">    --   g_buff := substr(g_buff, p + g_p - 1); --, nvl(length(g_buff), 0) - p + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">99</td><td class="code">    --   g_p    := 1;&#13;</td><td class="lineno">124</td><td class="code">    --   g_p    := 1;&#13;</td>
</tr>
<tr>
<td class="lineno">100</td><td class="code">  end;&#13;</td><td class="lineno">125</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">101</td><td class="code">&#13;</td><td class="lineno">126</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">102</td><td class="code">  function past_end(x integer) return boolean is&#13;</td><td class="lineno">127</td><td class="code">  FUNCTION past_end(x INTEGER) RETURN BOOLEAN IS&#13;</td>
</tr>
<tr>
<td class="lineno">103</td><td class="code">  begin&#13;</td><td class="lineno">128</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">104</td><td class="code">    return x &gt; len2;&#13;</td><td class="lineno">129</td><td class="code">    RETURN x &gt; len2;&#13;</td>
</tr>
<tr>
<td class="lineno">105</td><td class="code">  end;&#13;</td><td class="lineno">130</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">106</td><td class="code">&#13;</td><td class="lineno">131</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">107</td><td class="code">  procedure skip_to_end(i_pos integer</td><td class="lineno">132</td><td class="code">  PROCEDURE skip_to_end(i_pos   INTEGER&#13;</td>
</tr>
<tr>
<td class="lineno">107</td><td class="code"><span class="pad">                                     </span>, o_state out varchar2) is&#13;</td><td class="lineno">133</td><td class="code">                       ,o_state OUT VARCHAR2) IS&#13;</td>
</tr>
<tr>
<td class="lineno">108</td><td class="code">    -- i_pos is one after end of quotet field&#13;</td><td class="lineno">134</td><td class="code">    -- i_pos is one after end of quotet field&#13;</td>
</tr>
<tr>
<td class="lineno">109</td><td class="code">    -- skip to pos after end of line&#13;</td><td class="lineno">135</td><td class="code">    -- skip to pos after end of line&#13;</td>
</tr>
<tr>
<td class="lineno">110</td><td class="code">  &#13;</td><td class="lineno">136</td><td class="code">  &#13;</td>
</tr>
<tr>
<td class="lineno">111</td><td class="code">    posd  integer;&#13;</td><td class="lineno">137</td><td class="code">    posd  INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">112</td><td class="code">    posnl integer;&#13;</td><td class="lineno">138</td><td class="code">    posnl INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">113</td><td class="code">  begin&#13;</td><td class="lineno">139</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">114</td><td class="code">    posd  := instr2(g_delim_char</td><td class="lineno">140</td><td class="code">    posd  := instr2(g_delim_char&#13;</td>
</tr>
<tr>
<td class="lineno">114</td><td class="code"><span class="pad">                                </span>, i_pos);&#13;</td><td class="lineno">141</td><td class="code">                   ,i_pos);&#13;</td>
</tr>
<tr>
<td class="lineno">115</td><td class="code">    posnl := instr2(chr(10)</td><td class="lineno">142</td><td class="code">    posnl := instr2(chr(10)&#13;</td>
</tr>
<tr>
<td class="lineno">115</td><td class="code"><span class="pad">                           </span>, i_pos);&#13;</td><td class="lineno">143</td><td class="code">                   ,i_pos);&#13;</td>
</tr>
<tr>
<td class="lineno">116</td><td class="code">    if posd &gt; 0 or posnl &gt; 0</td><td class="lineno">144</td><td class="code">    IF posd &gt; 0 OR posnl &gt; 0&#13;</td>
</tr>
<tr>
<td class="lineno">116</td><td class="code"><span class="pad">                            </span> then&#13;</td><td class="lineno">145</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">117</td><td class="code">      -- an end was found !&#13;</td><td class="lineno">146</td><td class="code">      -- an end was found !&#13;</td>
</tr>
<tr>
<td class="lineno">118</td><td class="code">      if (posd &gt; 0 and (posnl = 0 or posnl &gt; posd))</td><td class="lineno">147</td><td class="code">      IF (posd &gt; 0 AND (posnl = 0 OR posnl &gt; posd))&#13;</td>
</tr>
<tr>
<td class="lineno">118</td><td class="code"><span class="pad">                                                   </span> then&#13;</td><td class="lineno">148</td><td class="code">      THEN&#13;</td>
</tr>
<tr>
<td class="lineno">119</td><td class="code">        -- separator found&#13;</td><td class="lineno">149</td><td class="code">        -- separator found&#13;</td>
</tr>
<tr>
<td class="lineno">120</td><td class="code">        reset(posd + 1);&#13;</td><td class="lineno">150</td><td class="code">        reset(posd + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">121</td><td class="code">        o_state := k_found_delim;&#13;</td><td class="lineno">151</td><td class="code">        o_state := k_found_delim;&#13;</td>
</tr>
<tr>
<td class="lineno">122</td><td class="code">        return;&#13;</td><td class="lineno">152</td><td class="code">        RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">123</td><td class="code">      else&#13;</td><td class="lineno">153</td><td class="code">      ELSE&#13;</td>
</tr>
<tr>
<td class="lineno">124</td><td class="code">        -- end of line found&#13;</td><td class="lineno">154</td><td class="code">        -- end of line found&#13;</td>
</tr>
<tr>
<td class="lineno">125</td><td class="code">        reset(posnl + 1);&#13;</td><td class="lineno">155</td><td class="code">        reset(posnl + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">126</td><td class="code">        o_state := k_found_nl;&#13;</td><td class="lineno">156</td><td class="code">        o_state := k_found_nl;&#13;</td>
</tr>
<tr>
<td class="lineno">127</td><td class="code">        return;&#13;</td><td class="lineno">157</td><td class="code">        RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">128</td><td class="code">      end if;&#13;</td><td class="lineno">158</td><td class="code">      END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">129</td><td class="code">    else&#13;</td><td class="lineno">159</td><td class="code">    ELSE&#13;</td>
</tr>
<tr>
<td class="lineno">130</td><td class="code">      o_state := k_found_eof;&#13;</td><td class="lineno">160</td><td class="code">      o_state := k_found_eof;&#13;</td>
</tr>
<tr>
<td class="lineno">131</td><td class="code">      reset(len2 + 1);&#13;</td><td class="lineno">161</td><td class="code">      reset(len2 + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">132</td><td class="code">    end if;&#13;</td><td class="lineno">162</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">133</td><td class="code">  end;&#13;</td><td class="lineno">163</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">134</td><td class="code">&#13;</td><td class="lineno">164</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">135</td><td class="code">  procedure next_quoted_field(o_field out varchar2</td><td class="lineno">165</td><td class="code">  PROCEDURE next_quoted_field(o_field OUT VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">135</td><td class="code"><span class="pad">                                                  </span>, o_state out integer) is&#13;</td><td class="lineno">166</td><td class="code">                             ,o_state OUT INTEGER) IS&#13;</td>
</tr>
<tr>
<td class="lineno">136</td><td class="code">    x     integer;&#13;</td><td class="lineno">167</td><td class="code">    x     INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">137</td><td class="code">    q_pos integer;&#13;</td><td class="lineno">168</td><td class="code">    q_pos INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">138</td><td class="code">  begin&#13;</td><td class="lineno">169</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">139</td><td class="code">    p('q '||g_p);&#13;</td><td class="lineno">170</td><td class="code">    p('q ' || g_p);&#13;</td>
</tr>
<tr>
<td class="lineno">140</td><td class="code">    -- first char is quote char =&gt; v is not null!&#13;</td><td class="lineno">171</td><td class="code">    -- first char is quote char =&gt; v is not null!&#13;</td>
</tr>
<tr>
<td class="lineno">141</td><td class="code">    x:= g_p+1;&#13;</td><td class="lineno">172</td><td class="code">    x := g_p + 1;&#13;</td>
</tr>
<tr>
<td class="lineno">142</td><td class="code">    loop&#13;</td><td class="lineno">173</td><td class="code">    LOOP&#13;</td>
</tr>
<tr>
<td class="lineno">143</td><td class="code">      --  if past_end(x) then&#13;</td><td class="lineno">174</td><td class="code">      --  if past_end(x) then&#13;</td>
</tr>
<tr>
<td class="lineno">144</td><td class="code">      --    -- end of file&#13;</td><td class="lineno">175</td><td class="code">      --    -- end of file&#13;</td>
</tr>
<tr>
<td class="lineno">145</td><td class="code">      --    -- quoted field is not closed  ... play nice&#13;</td><td class="lineno">176</td><td class="code">      --    -- quoted field is not closed  ... play nice&#13;</td>
</tr>
<tr>
<td class="lineno">146</td><td class="code">      --     o_field := replace(substr2(2, len2 + 1),&#13;</td><td class="lineno">177</td><td class="code">      --     o_field := replace(substr2(2, len2 + 1),&#13;</td>
</tr>
<tr>
<td class="lineno">147</td><td class="code">      --                        g_quote_char || g_quote_char,&#13;</td><td class="lineno">178</td><td class="code">      --                        g_quote_char || g_quote_char,&#13;</td>
</tr>
<tr>
<td class="lineno">148</td><td class="code">      --                        g_quote_char);&#13;</td><td class="lineno">179</td><td class="code">      --                        g_quote_char);&#13;</td>
</tr>
<tr>
<td class="lineno">149</td><td class="code">      --    o_state := k_found_nl;&#13;</td><td class="lineno">180</td><td class="code">      --    o_state := k_found_nl;&#13;</td>
</tr>
<tr>
<td class="lineno">150</td><td class="code">      --     reset(x); -- := length(v)+1;&#13;</td><td class="lineno">181</td><td class="code">      --     reset(x); -- := length(v)+1;&#13;</td>
</tr>
<tr>
<td class="lineno">151</td><td class="code">      --     return;&#13;</td><td class="lineno">182</td><td class="code">      --     return;&#13;</td>
</tr>
<tr>
<td class="lineno">152</td><td class="code">      --   end if;&#13;</td><td class="lineno">183</td><td class="code">      --   end if;&#13;</td>
</tr>
<tr>
<td class="lineno">153</td><td class="code">      q_pos := instr2(g_quote_char</td><td class="lineno">184</td><td class="code">      q_pos := instr2(g_quote_char&#13;</td>
</tr>
<tr>
<td class="lineno">153</td><td class="code"><span class="pad">                                  </span>, x);&#13;</td><td class="lineno">185</td><td class="code">                     ,x);&#13;</td>
</tr>
<tr>
<td class="lineno">154</td><td class="code">      if q_pos = 0</td><td class="lineno">186</td><td class="code">      IF q_pos = 0&#13;</td>
</tr>
<tr>
<td class="lineno">154</td><td class="code"><span class="pad">                  </span> then&#13;</td><td class="lineno">187</td><td class="code">      THEN&#13;</td>
</tr>
<tr>
<td class="lineno">155</td><td class="code">        -- not closed &#13;</td><td class="lineno">188</td><td class="code">        -- not closed &#13;</td>
</tr>
<tr>
<td class="lineno">156</td><td class="code">        o_field := replace(substr(g_p + 1</td><td class="lineno">189</td><td class="code">        o_field := REPLACE(substr(g_p + 1&#13;</td>
</tr>
<tr>
<td class="lineno">156</td><td class="code"><span class="pad">                                         </span>, len2 + 1)</td><td class="lineno">190</td><td class="code">                                 ,len2 + 1)&#13;</td>
</tr>
<tr>
<td class="lineno">156</td><td class="code"><span class="pad">                                                    </span>,&#13;</td><td class="lineno">191</td><td class="code">                          ,</td>
</tr>
<tr>
<td class="lineno">157</td><td class="code">                           g_quote_char || g_quote_char</td><td class="lineno">191</td><td class="code"><span class="pad">                           </span>g_quote_char || g_quote_char&#13;</td>
</tr>
<tr>
<td class="lineno">157</td><td class="code"><span class="pad">                                                       </span>,&#13;</td><td class="lineno">192</td><td class="code">                          ,</td>
</tr>
<tr>
<td class="lineno">158</td><td class="code">                           g_quote_char);&#13;</td><td class="lineno">192</td><td class="code"><span class="pad">                           </span>g_quote_char);&#13;</td>
</tr>
<tr>
<td class="lineno">159</td><td class="code">        o_state := k_found_eof;&#13;</td><td class="lineno">193</td><td class="code">        o_state := k_found_eof;&#13;</td>
</tr>
<tr>
<td class="lineno">160</td><td class="code">        return;&#13;</td><td class="lineno">194</td><td class="code">        RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">161</td><td class="code">      end if;&#13;</td><td class="lineno">195</td><td class="code">      END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">162</td><td class="code">      -- found quote char&#13;</td><td class="lineno">196</td><td class="code">      -- found quote char&#13;</td>
</tr>
<tr>
<td class="lineno">163</td><td class="code">      -- we need the next char ...&#13;</td><td class="lineno">197</td><td class="code">      -- we need the next char ...&#13;</td>
</tr>
<tr>
<td class="lineno">164</td><td class="code">      if past_end(q_pos + 1)</td><td class="lineno">198</td><td class="code">      IF past_end(q_pos + 1)&#13;</td>
</tr>
<tr>
<td class="lineno">164</td><td class="code"><span class="pad">                            </span> then&#13;</td><td class="lineno">199</td><td class="code">      THEN&#13;</td>
</tr>
<tr>
<td class="lineno">165</td><td class="code">        -- no next char&#13;</td><td class="lineno">200</td><td class="code">        -- no next char&#13;</td>
</tr>
<tr>
<td class="lineno">166</td><td class="code">        o_field := replace(substr2(g_p + 1</td><td class="lineno">201</td><td class="code">        o_field := REPLACE(substr2(g_p + 1&#13;</td>
</tr>
<tr>
<td class="lineno">166</td><td class="code"><span class="pad">                                          </span>, q_pos)</td><td class="lineno">202</td><td class="code">                                  ,q_pos)&#13;</td>
</tr>
<tr>
<td class="lineno">166</td><td class="code"><span class="pad">                                                  </span>,&#13;</td><td class="lineno">203</td><td class="code">                          ,</td>
</tr>
<tr>
<td class="lineno">167</td><td class="code">                           g_quote_char || g_quote_char</td><td class="lineno">203</td><td class="code"><span class="pad">                           </span>g_quote_char || g_quote_char&#13;</td>
</tr>
<tr>
<td class="lineno">167</td><td class="code"><span class="pad">                                                       </span>,&#13;</td><td class="lineno">204</td><td class="code">                          ,</td>
</tr>
<tr>
<td class="lineno">168</td><td class="code">                           g_quote_char);&#13;</td><td class="lineno">204</td><td class="code"><span class="pad">                           </span>g_quote_char);&#13;</td>
</tr>
<tr>
<td class="lineno">169</td><td class="code">        o_state := k_found_eof;&#13;</td><td class="lineno">205</td><td class="code">        o_state := k_found_eof;&#13;</td>
</tr>
<tr>
<td class="lineno">170</td><td class="code">        reset(q_pos + 1);&#13;</td><td class="lineno">206</td><td class="code">        reset(q_pos + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">171</td><td class="code">        return;&#13;</td><td class="lineno">207</td><td class="code">        RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">172</td><td class="code">      end if;&#13;</td><td class="lineno">208</td><td class="code">      END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">173</td><td class="code">      if substr2(q_pos + 1</td><td class="lineno">209</td><td class="code">      IF substr2(q_pos + 1&#13;</td>
</tr>
<tr>
<td class="lineno">173</td><td class="code"><span class="pad">                          </span>, q_pos + 2) != g_quote_char</td><td class="lineno">210</td><td class="code">                ,q_pos + 2) != g_quote_char&#13;</td>
</tr>
<tr>
<td class="lineno">173</td><td class="code"><span class="pad">                                                      </span> then&#13;</td><td class="lineno">211</td><td class="code">      THEN&#13;</td>
</tr>
<tr>
<td class="lineno">174</td><td class="code">        -- at the end of field&#13;</td><td class="lineno">212</td><td class="code">        -- at the end of field&#13;</td>
</tr>
<tr>
<td class="lineno">175</td><td class="code">        p('---'||q_pos);&#13;</td><td class="lineno">213</td><td class="code">        p('---' || q_pos);&#13;</td>
</tr>
<tr>
<td class="lineno">176</td><td class="code">        o_field := replace(substr2(g_p + 1</td><td class="lineno">214</td><td class="code">        o_field := REPLACE(substr2(g_p + 1&#13;</td>
</tr>
<tr>
<td class="lineno">176</td><td class="code"><span class="pad">                                          </span>, q_pos)</td><td class="lineno">215</td><td class="code">                                  ,q_pos)&#13;</td>
</tr>
<tr>
<td class="lineno">176</td><td class="code"><span class="pad">                                                  </span>,&#13;</td><td class="lineno">216</td><td class="code">                          ,</td>
</tr>
<tr>
<td class="lineno">177</td><td class="code">                           g_quote_char || g_quote_char</td><td class="lineno">216</td><td class="code"><span class="pad">                           </span>g_quote_char || g_quote_char&#13;</td>
</tr>
<tr>
<td class="lineno">177</td><td class="code"><span class="pad">                                                       </span>,&#13;</td><td class="lineno">217</td><td class="code">                          ,</td>
</tr>
<tr>
<td class="lineno">178</td><td class="code">                           g_quote_char);&#13;</td><td class="lineno">217</td><td class="code"><span class="pad">                           </span>g_quote_char);&#13;</td>
</tr>
<tr>
<td class="lineno">179</td><td class="code">        skip_to_end(q_pos + 1</td><td class="lineno">218</td><td class="code">        skip_to_end(q_pos + 1&#13;</td>
</tr>
<tr>
<td class="lineno">179</td><td class="code"><span class="pad">                             </span>, o_state);&#13;</td><td class="lineno">219</td><td class="code">                   ,o_state);&#13;</td>
</tr>
<tr>
<td class="lineno">180</td><td class="code">        return;&#13;</td><td class="lineno">220</td><td class="code">        RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">181</td><td class="code">      else&#13;</td><td class="lineno">221</td><td class="code">      ELSE&#13;</td>
</tr>
<tr>
<td class="lineno">182</td><td class="code">        x := q_pos + 2;&#13;</td><td class="lineno">222</td><td class="code">        x := q_pos + 2;&#13;</td>
</tr>
<tr>
<td class="lineno">183</td><td class="code">      end if;&#13;</td><td class="lineno">223</td><td class="code">      END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">184</td><td class="code">    end loop;&#13;</td><td class="lineno">224</td><td class="code">    END LOOP;&#13;</td>
</tr>
<tr>
<td class="lineno">185</td><td class="code">  end;&#13;</td><td class="lineno">225</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">186</td><td class="code">&#13;</td><td class="lineno">226</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">187</td><td class="code">  -- buffer is string&#13;</td><td class="lineno">227</td><td class="code">  -- buffer is string&#13;</td>
</tr>
<tr>
<td class="lineno">188</td><td class="code">  -- start position is integer&#13;</td><td class="lineno">228</td><td class="code">  -- start position is integer&#13;</td>
</tr>
<tr>
<td class="lineno">189</td><td class="code">  -- on next field both is set&#13;</td><td class="lineno">229</td><td class="code">  -- on next field both is set&#13;</td>
</tr>
<tr>
<td class="lineno">190</td><td class="code">  -- at end if &#13;</td><td class="lineno">230</td><td class="code">  -- at end if &#13;</td>
</tr>
<tr>
<td class="lineno">191</td><td class="code">  -- g_p&gt; length(buffer)&#13;</td><td class="lineno">231</td><td class="code">  -- g_p&gt; length(buffer)&#13;</td>
</tr>
<tr>
<td class="lineno">192</td><td class="code">  -- g_buff and g_p can change with calls to getchars&#13;</td><td class="lineno">232</td><td class="code">  -- g_buff and g_p can change with calls to getchars&#13;</td>
</tr>
<tr>
<td class="lineno">193</td><td class="code">  -- getchars always works, returns if chars where found&#13;</td><td class="lineno">233</td><td class="code">  -- getchars always works, returns if chars where found&#13;</td>
</tr>
<tr>
<td class="lineno">194</td><td class="code">  -- reset set&#13;</td><td class="lineno">234</td><td class="code">  -- reset set&#13;</td>
</tr>
<tr>
<td class="lineno">195</td><td class="code">  procedure next_field(o_field out varchar2</td><td class="lineno">235</td><td class="code">  PROCEDURE next_field(o_field OUT VARCHAR2&#13;</td>
</tr>
<tr>
<td class="lineno">195</td><td class="code"><span class="pad">                                           </span>, o_state out integer) is&#13;</td><td class="lineno">236</td><td class="code">                      ,o_state OUT INTEGER) IS&#13;</td>
</tr>
<tr>
<td class="lineno">196</td><td class="code">    res   varchar2(32000);&#13;</td><td class="lineno">237</td><td class="code">    res   VARCHAR2(32000);&#13;</td>
</tr>
<tr>
<td class="lineno">197</td><td class="code">    posd  integer;&#13;</td><td class="lineno">238</td><td class="code">    posd  INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">198</td><td class="code">    posnl integer;&#13;</td><td class="lineno">239</td><td class="code">    posnl INTEGER;&#13;</td>
</tr>
<tr>
<td class="lineno">199</td><td class="code">    --  posq integer;&#13;</td><td class="lineno">240</td><td class="code">    --  posq integer;&#13;</td>
</tr>
<tr>
<td class="lineno">200</td><td class="code">  begin&#13;</td><td class="lineno">241</td><td class="code">  BEGIN&#13;</td>
</tr>
<tr>
<td class="lineno">201</td><td class="code">    p('NF:' ||g_p);&#13;</td><td class="lineno">242</td><td class="code">    p('NF:' || g_p);&#13;</td>
</tr>
<tr>
<td class="lineno">202</td><td class="code">    if past_end(g_p)</td><td class="lineno">243</td><td class="code">    IF past_end(g_p)&#13;</td>
</tr>
<tr>
<td class="lineno">202</td><td class="code"><span class="pad">                    </span> then&#13;</td><td class="lineno">244</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">203</td><td class="code">      o_field := null;&#13;</td><td class="lineno">245</td><td class="code">      o_field := NULL;&#13;</td>
</tr>
<tr>
<td class="lineno">204</td><td class="code">      o_state := k_found_eof;&#13;</td><td class="lineno">246</td><td class="code">      o_state := k_found_eof;&#13;</td>
</tr>
<tr>
<td class="lineno">205</td><td class="code">      return;&#13;</td><td class="lineno">247</td><td class="code">      RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">206</td><td class="code">    end if;&#13;</td><td class="lineno">248</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">207</td><td class="code">  &#13;</td><td class="lineno">249</td><td class="code">  &#13;</td>
</tr>
<tr>
<td class="lineno">208</td><td class="code">    -- if the first char is quote it is a quotet field,&#13;</td><td class="lineno">250</td><td class="code">    -- if the first char is quote it is a quotet field,&#13;</td>
</tr>
<tr>
<td class="lineno">209</td><td class="code">    -- may be less conditions&#13;</td><td class="lineno">251</td><td class="code">    -- may be less conditions&#13;</td>
</tr>
<tr>
<td class="lineno">210</td><td class="code">    if substr2(<span class="hot">g_p</span></td><td class="lineno">252</td><td class="code">    IF substr2(<span class="hot">g_px</span>&#13;</td>
</tr>
<tr>
<td class="lineno">210</td><td class="code"><span class="pad">                  </span>, g_p + 1) = g_quote_char</td><td class="lineno">253</td><td class="code">              ,g_p + 1) = g_quote_char&#13;</td>
</tr>
<tr>
<td class="lineno">210</td><td class="code"><span class="pad">                                           </span> then&#13;</td><td class="lineno">254</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">211</td><td class="code">      next_quoted_field(o_field</td><td class="lineno">255</td><td class="code">      next_quoted_field(o_field&#13;</td>
</tr>
<tr>
<td class="lineno">211</td><td class="code"><span class="pad">                               </span>, o_state);&#13;</td><td class="lineno">256</td><td class="code">                       ,o_state);&#13;</td>
</tr>
<tr>
<td class="lineno"></td><td class="code"></td><td class="lineno">257</td><td class="code">    &#13;</td>
</tr>
<tr>
<td class="lineno"></td><td class="code"></td><td class="lineno">258</td><td class="code">      --sasa&#13;</td>
</tr>
<tr>
<td class="lineno"></td><td class="code"></td><td class="lineno">259</td><td class="code">      --assa&#13;</td>
</tr>
<tr>
<td class="lineno"></td><td class="code"></td><td class="lineno">260</td><td class="code">      --assassa&#13;</td>
</tr>
<tr>
<td class="lineno"></td><td class="code"></td><td class="lineno">261</td><td class="code">    &#13;</td>
</tr>
<tr>
<td class="lineno">212</td><td class="code">      return;&#13;</td><td class="lineno">262</td><td class="code">      RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">213</td><td class="code">    end if;&#13;</td><td class="lineno">263</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">214</td><td class="code">    posd  := instr2(g_delim_char</td><td class="lineno">264</td><td class="code">    posd  := instr2(g_delim_char&#13;</td>
</tr>
<tr>
<td class="lineno">214</td><td class="code"><span class="pad">                                </span>, g_p);&#13;</td><td class="lineno">265</td><td class="code">                   ,g_p);&#13;</td>
</tr>
<tr>
<td class="lineno">215</td><td class="code">    posnl := instr2(chr(10)</td><td class="lineno">266</td><td class="code">    posnl := instr2(chr(10)&#13;</td>
</tr>
<tr>
<td class="lineno">215</td><td class="code"><span class="pad">                           </span>, g_p);&#13;</td><td class="lineno">267</td><td class="code">                   ,g_p);&#13;</td>
</tr>
<tr>
<td class="lineno">216</td><td class="code">    p('pos: '||posd||' '||posnl);&#13;</td><td class="lineno">268</td><td class="code">    p('pos: ' || posd || ' ' || posnl);&#13;</td>
</tr>
<tr>
<td class="lineno">217</td><td class="code">    if posd = 0 and posnl = 0</td><td class="lineno">269</td><td class="code">    IF posd = 0 AND posnl = 0&#13;</td>
</tr>
<tr>
<td class="lineno">217</td><td class="code"><span class="pad">                             </span> then&#13;</td><td class="lineno">270</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">218</td><td class="code">      <span class="hot">o_field</span> <span class="hot">:=</span> <span class="hot">substr2</span><span class="hot">(</span><span class="hot">g_p</span><span class="hot">,</span> <span class="hot">len2</span> <span class="hot">+</span> <span class="hot">1</span><span class="hot">)</span><span class="hot">;</span>&#13;</td><td class="lineno"></td><td class="code"></td>
</tr>
<tr>
<td class="lineno">219</td><td class="code">      <span class="hot">o_state</span> <span class="hot">:=</span> <span class="hot">k_found_eof</span><span class="hot">;</span>&#13;</td><td class="lineno"></td><td class="code"></td>
</tr>
<tr>
<td class="lineno">220</td><td class="code">      <span class="hot">reset</span><span class="hot">(</span><span class="hot">len2</span><span class="hot">+</span><span class="hot">1</span><span class="hot">)</span><span class="hot">;</span>&#13;</td><td class="lineno"></td><td class="code"></td>
</tr>
<tr>
<td class="lineno">221</td><td class="code">      <span class="hot">return</span><span class="hot">;</span>&#13;</td><td class="lineno"></td><td class="code"></td>
</tr>
<tr>
<td class="lineno">222</td><td class="code">    end if;&#13;</td><td class="lineno">271</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">223</td><td class="code">    if posd != 0 and (posd &lt; posnl or posnl = 0)</td><td class="lineno">272</td><td class="code">    IF posd != 0 AND (posd &lt; posnl OR posnl = 0)&#13;</td>
</tr>
<tr>
<td class="lineno">223</td><td class="code"><span class="pad">                                                </span> then&#13;</td><td class="lineno">273</td><td class="code">    THEN&#13;</td>
</tr>
<tr>
<td class="lineno">224</td><td class="code">      -- found sep and later no or later NL&#13;</td><td class="lineno">274</td><td class="code">      -- found sep and later no or later NL&#13;</td>
</tr>
<tr>
<td class="lineno">225</td><td class="code">      res     := substr2(g_p</td><td class="lineno">275</td><td class="code">      res     := substr2(g_p&#13;</td>
</tr>
<tr>
<td class="lineno">225</td><td class="code"><span class="pad">                            </span>, posd);&#13;</td><td class="lineno">276</td><td class="code">                        ,posd);&#13;</td>
</tr>
<tr>
<td class="lineno">226</td><td class="code">      o_field := res;&#13;</td><td class="lineno">277</td><td class="code">      o_field := res;&#13;</td>
</tr>
<tr>
<td class="lineno">227</td><td class="code">      o_state := k_found_delim;&#13;</td><td class="lineno">278</td><td class="code">      o_state := k_found_delim;&#13;</td>
</tr>
<tr>
<td class="lineno">228</td><td class="code">      reset(posd + 1);&#13;</td><td class="lineno">279</td><td class="code">      reset(posd + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">229</td><td class="code">      return;&#13;</td><td class="lineno">280</td><td class="code">      RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">230</td><td class="code">    else&#13;</td><td class="lineno">281</td><td class="code">    ELSE&#13;</td>
</tr>
<tr>
<td class="lineno">231</td><td class="code">      res     := substr2(g_p</td><td class="lineno">282</td><td class="code">      res     := substr2(g_p&#13;</td>
</tr>
<tr>
<td class="lineno">231</td><td class="code"><span class="pad">                            </span>, posnl);&#13;</td><td class="lineno">283</td><td class="code">                        ,posnl);&#13;</td>
</tr>
<tr>
<td class="lineno">232</td><td class="code">      o_field := res;&#13;</td><td class="lineno">284</td><td class="code">      o_field := res;&#13;</td>
</tr>
<tr>
<td class="lineno">233</td><td class="code">      reset(posnl + 1);&#13;</td><td class="lineno">285</td><td class="code">      reset(posnl + 1);&#13;</td>
</tr>
<tr>
<td class="lineno">234</td><td class="code">      o_state := k_found_nl;&#13;</td><td class="lineno">286</td><td class="code">      o_state := <span class="hot">xyz</span> k_found_nl;&#13;</td>
</tr>
<tr>
<td class="lineno">235</td><td class="code">      return;&#13;</td><td class="lineno">287</td><td class="code">      RETURN;&#13;</td>
</tr>
<tr>
<td class="lineno">236</td><td class="code">    end if;&#13;</td><td class="lineno">288</td><td class="code">    END IF;&#13;</td>
</tr>
<tr>
<td class="lineno">237</td><td class="code">  end;&#13;</td><td class="lineno">289</td><td class="code">  END;&#13;</td>
</tr>
<tr>
<td class="lineno">238</td><td class="code">&#13;</td><td class="lineno">290</td><td class="code">&#13;</td>
</tr>
<tr>
<td class="lineno">239</td><td class="code">end csv;&#13;</td><td class="lineno">291</td><td class="code">END csv;&#13;</td>
</tr>
<tr>
<td class="lineno">240</td><td class="code">/&#13;</td><td class="lineno">292</td><td class="code">/&#13;</td>
</tr>
<tr>
<td class="lineno">241</td><td class="code"></td><td class="lineno">293</td><td class="code"></td>
</tr>
</table>
</body>
</html>
